@model Portfolio_Management.Models.StaffDashboardViewModel

<!-- page content -->

@if (Model.SelectedStaffData.Staff != null)
{
    <div class="col-md-6 col-sm-10 col-xs-12">

        @{Html.RenderAction("ManageStaffSkillModal", new { id = Model.SelectedStaffData.Staff.ID});}

        <div class="x_panel">
            <div class="x_title">
                <h2>
                    @Html.DisplayFor(model => model.SelectedStaffData.Staff.First_Name)'s Skills
                </h2>
                <ul class="nav navbar-right panel_toolbox">
                    <li>
                        
                        <a title="Manage @Html.DisplayFor(model => model.SelectedStaffData.Staff.First_Name)' Skills" @*href="javascript:getStaffID(@Model.SelectedStaffData.Staff.ID)"*@  data-toggle="modal" data-target="#myModal" @*href="#staffSkillModal" onclick="getStaffID(@Model.SelectedStaffData.Staff.ID)" id="showModalBtn"*@ role="button" aria-expanded="false"><i class="fa fa-plus-square"></i></a>
                        @*<div id='staffSkillModal' class='modal fade in' data-url='@Url.Action("ManageStaffSkillModal",new { id = Model.SelectedStaffData.Staff.ID })'></div>*@
                        @*<a title="Manage @Html.DisplayFor(model => model.SelectedStaffData.Staff.First_Name)' Skills" href="javascript:void(0);" data-id="@Model.SelectedStaffData.Staff.ID" class="staffSkillModalAnchor" role="button" aria-expanded="false"><i class="fa fa-plus-square"></i></a>*@ 
                    </li>
                    <li>
                       
                    </li>
                    <li>
                        <a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                    </li>
                    <li>
                        <a class="close-link"><i class="fa fa-close"></i></a>
                    </li>
                </ul>
                <div class="clearfix"></div>
            </div>
            
            <div class="x_content">
                <div style="overflow-x:auto">
                    <table id="datatable-responsive" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" style="width:100%">
                        <thead>
                            <tr>
                                <th>
                                    @Html.DisplayNameFor(model => model.SelectedStaffData.StaffSkills[0].Created_On)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.SelectedStaffData.StaffSkills[0].Created_By)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.SelectedStaffData.StaffSkills[0].Modified_On)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.SelectedStaffData.StaffSkills[0].Modified_By)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.SelectedStaffData.StaffSkills[0].Adm_Proficiency.Proficiency)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.SelectedStaffData.StaffSkills[0].Ref_Skill.Skill)
                                </th>
                                <th>
                                    @Html.DisplayNameFor(model => model.SelectedStaffData.StaffSkills[0].Staff.Staff_Name)
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.SelectedStaffData.StaffSkills)
                            {
                                <tr>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Created_On)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Created_By)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Modified_On)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Modified_By)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Adm_Proficiency.Proficiency)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Ref_Skill.Skill)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Staff.Staff_Name)
                                    </td>

                                    <td>
                                        <a href='@Url.Action("Edit", "Staff_Skill", new { Staff_ID = item.Staff_ID, Skill_ID = item.Skill_ID })'>
                                            <span class="glyphicon glyphicon-edit" aria-hidden="true" aria-label="Edit Education"></span>
                                        </a>

                                        <a href='@Url.Action("Delete", "Staff_Skill", new { Staff_ID = item.Staff_ID, Skill_ID = item.Skill_ID })'>
                                            <span class="glyphicon glyphicon-remove" aria-hidden="true" aria-label="Delete Education"></span>
                                        </a>
                                    </td>

                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        @*<script>
            $(function() {
                $('.staffSkillModal').modal();
                //$('#staffSkillModal').modal('show'); 
            });

            function getStaffID(@Model.SelectedStaffData.Staff.ID) {
                $.ajax({
                    url: '/Staff/ManageStaffSkillModal/' + @Model.SelectedStaffData.Staff.ID, // The method name + paramater
                    method: "POST",
                    success: function(data) {
                        $('#staffSkillModalWrapper').html(data); // This should be an empty div where you can inject your new html (the partial view)
                       
                    }
                });
            }

        </script>*@
        <script>

            var TeamDetailPostBackURL = '/Staff/ManageStaffSkillModal';
    $(function () {
        $(".staffSkillModalAnchor").click(function () {
            debugger;
            var $buttonClicked = $(this);
            var id = $buttonClicked.attr('data-id');
            var options = { "backdrop": "static", keyboard: true };
            $.ajax({
                type: "GET",
                url: '@Url.Action("ManageStaffSkillModal", "Staff")',
                contentType: "application/json; charset=utf-8",
                data: { "id": id },
                datatype: "json",
                success: function (data) {
                    debugger;
                    $('#myModalContent').html(data);
                    $('#myModal').modal(options);
                    $('#myModal').modal('show');

                },
                error: function () {
                    alert("Dynamic content load failed.");
                }
            });

            @*$.ajax({
                url: '@Url.Action("ManageStaffSkillModal", "Staff")',
                data: { id: id },
                method: "GET",
                success: function (data) {
                    $('#myModalContent').html(data);
                    $('#myModal').modal('show');

                },
                error: function (xhr, status, error) {
                    alert(xhr.responseText);
                }
            });*@
        });
        //$("#closebtn").on('click',function(){
        //    $('#myModal').modal('hide');

        $("#closbtn").click(function () {
            $('#myModal').modal('hide');
        });
    });

        </script>  
    </div>
}
<!-- /page content -->

